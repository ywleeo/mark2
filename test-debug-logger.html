<!DOCTYPE html>
<html>
<head>
    <title>DebugLogger Test</title>
</head>
<body>
    <h1>DebugLogger 测试页面</h1>
    <button id="testLogs">测试各种日志类型</button>
    <button id="testError">测试错误日志</button>
    <button id="testObject">测试对象日志</button>
    <button id="readLog">读取debug.log文件</button>
    
    <div>
        <h3>Debug Log 内容:</h3>
        <pre id="logContent" style="background: #f5f5f5; padding: 10px; max-height: 300px; overflow-y: auto;"></pre>
    </div>

    <script>
        // 模拟Electron环境
        const { ipcRenderer } = require('electron');
        const { initDebugLogger } = require('./src/utils/DebugLogger');

        // 初始化Debug Logger
        const debugLogger = initDebugLogger();

        console.log('测试页面已加载');

        // 测试各种日志类型
        document.getElementById('testLogs').addEventListener('click', () => {
            console.log('这是一条普通日志');
            console.info('这是一条信息日志');
            console.warn('这是一条警告日志');
            console.error('这是一条错误日志');
            console.debug('这是一条调试日志');
        });

        // 测试错误日志
        document.getElementById('testError').addEventListener('click', () => {
            try {
                throw new Error('这是一个测试错误');
            } catch (error) {
                console.error('捕获到错误:', error);
            }
        });

        // 测试对象日志
        document.getElementById('testObject').addEventListener('click', () => {
            const testObj = {
                name: 'DebugLogger测试',
                version: '1.0.0',
                features: ['console拦截', '文件写入', '缓冲机制'],
                nested: {
                    level1: {
                        level2: 'deep object'
                    }
                }
            };
            console.log('测试对象:', testObj);
        });

        // 读取debug.log文件
        document.getElementById('readLog').addEventListener('click', async () => {
            try {
                const result = await ipcRenderer.invoke('read-debug-log');
                if (result.success) {
                    document.getElementById('logContent').textContent = result.content;
                } else {
                    console.error('读取日志失败:', result.error);
                }
            } catch (error) {
                console.error('读取日志出错:', error);
            }
        });
    </script>
</body>
</html>