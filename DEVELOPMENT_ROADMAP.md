# mark2 开发路线图

> **当前版本**: v0.83  
> **创建时间**: 2025-07-28  
> **状态**: 活跃开发中  

## 🎯 项目愿景

mark2 致力于成为一个简洁、高效、功能丰富的 Markdown 阅读器和编辑器，专注于提供优雅的文档阅读和编辑体验。

---

## to-do
1. ~~搜索有 bug，无法高亮搜索内容，也不能下一个上一个找到搜索内容。~~
1. ~~menu 里去掉段落紧凑之类的设定。多余。~~
1. ~~设置界面，设置字间距不起作用。~~
1. ~~设置的字号行距字间距字体等也要作用于编辑模式。~~
1. view模式进入编辑模式后，scroll 到相同的位置。
1. keyword 高亮现在用不了，要加快捷键。可能需要重构，去掉动词，只标注关键的名词，代词，数字，时间，地点等。
1. ~~搜索的样式做漂亮点。~~
1. 目录树的 icon 可以搞漂亮点。
1. 导出后测试右键打开文件好不好用，大概率不好用。
1. markdown 的样式看起来有点单调，可以搞好看一点，比如二级标题下不是加<hr>，而是做一个一半高度的背景色之类的。

## 📊 当前功能状态 (v0.83)

### ✅ 已实现核心功能
- **文件管理**
  - 智能模式切换（单文件模式 ⇄ 文件夹模式）
  - 拖拽支持（文件/文件夹）
  - 快捷键操作（Cmd+O、Cmd+Shift+O）
  - 文件关联和命令行支持

- **编辑器功能**
  - Markdown 预览和编辑模式
  - 实时保存（Cmd+S）
  - 语法高亮（基于 highlight.js）
  - 关键词高亮

- **界面体验**
  - 响应式侧边栏（智能显示/隐藏）
  - 文件树导航
  - 深色/浅色主题切换
  - 文档内搜索功能
  - 字体和排版设置

- **系统集成**
  - macOS 原生体验
  - 窗口状态管理
  - 文件监听和自动更新

---

## 🚀 短期计划 (v0.84 - v0.89)

### 🎨 用户体验增强

#### v0.84: 编辑器体验优化
**优先级**: 🔴 高
- [ ] **编辑器增强**
  - 行号显示开关
  - 代码折叠功能
  - 选中文本统计（字符数、行数）
  - 拖拽插入文件（图片、文档链接）

- [ ] **快捷键完善**
  - 文档内快速跳转（Cmd+G 跳转到行）
  - 全文替换功能（Cmd+Option+F）
  - 撤销/重做增强（Cmd+Z、Cmd+Shift+Z）

#### v0.85: 预览增强
**优先级**: 🔴 高
- [ ] **预览功能**
  - 表格渲染优化
  - 数学公式支持（KaTeX/MathJax）
  - 图表支持（mermaid 图表）
  - 任务列表交互（checkbox 点击）

- [ ] **导出功能**
  - PDF 导出
  - HTML 导出
  - 打印功能优化

#### v0.86: 文件管理增强
**优先级**: 🟡 中
- [ ] **文件操作**
  - 文件重命名（右键菜单）
  - 新建文件/文件夹
  - 文件删除（移至废纸篓）
  - 最近打开文件列表

- [ ] **搜索增强**
  - 全局文件搜索（跨文件）
  - 搜索结果高亮
  - 正则表达式搜索

### 🔧 技术改进

#### v0.87: 性能优化
**优先级**: 🟡 中
- [ ] **渲染优化**
  - 大文件加载优化（虚拟滚动）
  - 预览渲染缓存
  - 文件树性能优化（懒加载）

- [ ] **内存管理**
  - 内存泄漏检查和修复
  - 图片资源优化加载
  - 缓存策略优化

#### v0.88: 错误处理和稳定性
**优先级**: 🔴 高
- [ ] **错误处理完善**
  - 文件读取失败的友好提示
  - 网络资源加载失败处理
  - 崩溃恢复机制

- [ ] **日志和调试**
  - 结构化日志系统
  - 用户反馈收集机制
  - 开发者调试工具

#### v0.89: 扩展能力
**优先级**: 🟢 低
- [ ] **插件系统基础**
  - 主题扩展机制
  - 简单插件 API 设计
  - 配置文件标准化

---

## 🎯 中期计划 (v0.9x)

### 📝 编辑器进阶功能
- **智能编辑**
  - 自动补全（链接、图片、标题）
  - 代码片段模板
  - 格式化快捷键（粗体、斜体、链接）
  - 表格编辑器

- **协作功能基础**
  - 版本历史（本地）
  - 文档比较（diff）
  - 注释和批注功能

### 🔗 集成和互操作
- **外部工具集成**
  - Git 状态显示
  - 图床服务集成
  - 云存储同步（可选）

- **格式支持扩展**
  - 其他标记语言支持
  - 文档格式转换
  - 多语言文档处理

---

## 🔮 长期愿景 (v1.0+)

### 🌐 平台扩展
- **跨平台优化**
  - Windows 版本优化
  - Linux 支持
  - 移动端阅读器（可选）

### 🤖 智能功能
- **AI 辅助**
  - 智能摘要生成
  - 语法和内容建议
  - 自动标签和分类

### 👥 团队协作
- **高级协作**
  - 实时协作编辑
  - 评论和审查系统
  - 权限管理

---

## 🔧 技术债务和重构计划

### 当前技术债务识别

#### 🚨 紧急修复
1. **FileWatcher 错误处理**
   - 位置: `src/main/FileWatcher.js:17`
   - 问题: `path` 参数未定义导致监听失败
   - 影响: 文件自动更新功能异常

2. **版本号不一致**
   - 位置: `package.json:4`
   - 问题: 版本仍显示 0.8.0，应为 0.8.3
   - 影响: 版本管理混乱

#### 🟡 架构改进
1. **错误处理标准化**
   - 统一错误处理和用户反馈机制
   - 完善日志记录系统
   - 改进错误恢复策略

2. **状态管理优化**
   - 考虑引入状态管理库（如简化版 Redux）
   - 统一应用状态更新机制
   - 改进组件间通信

3. **代码模块化增强**
   - 服务层抽象（文件操作、设置管理）
   - 工具类函数整合
   - 常量和配置统一管理

---

## 📋 开发优先级矩阵

| 功能/修复 | 用户影响 | 开发复杂度 | 优先级 | 计划版本 |
|-----------|----------|------------|--------|----------|
| FileWatcher 修复 | 高 | 低 | 🔴 紧急 | v0.84 |
| 编辑器行号 | 中 | 低 | 🟡 高 | v0.84 |
| PDF 导出 | 高 | 中 | 🟡 高 | v0.85 |
| 数学公式支持 | 中 | 中 | 🟡 中 | v0.85 |
| 全局搜索 | 高 | 高 | 🟡 中 | v0.86 |
| 性能优化 | 中 | 高 | 🟢 中 | v0.87 |
| 插件系统 | 低 | 高 | 🟢 低 | v0.89 |

---

## 🤝 贡献指南

### 开发环境设置
```bash
# 克隆项目
git clone https://github.com/ywleeo/mark2.git
cd mark2

# 安装依赖
npm install

# 开发模式运行
npm run dev

# 构建应用
npm run build
```

### 代码规范
- 使用 ES6+ 语法
- 遵循模块化设计原则
- 保持代码注释完整
- 提交信息使用约定式提交格式

### 测试策略
- 手动测试核心用例
- 关键功能自动化测试（计划中）
- 性能回归测试（计划中）

---

## 📞 反馈和建议

如果你有任何建议、bug 报告或功能请求，请通过以下方式联系：

- **GitHub Issues**: [提交问题](https://github.com/ywleeo/mark2/issues)
- **功能请求**: 在 Issues 中使用 `enhancement` 标签
- **Bug 报告**: 在 Issues 中使用 `bug` 标签

---

## 📈 版本发布计划

| 版本 | 预计发布时间 | 主要功能 | 状态 |
|------|-------------|----------|------|
| v0.83 | 2025-07-28 | 模式切换、界面简化 | ✅ 已发布 |
| v0.84 | 2025-08-15 | 编辑器增强、错误修复 | 🚧 开发中 |
| v0.85 | 2025-09-01 | 预览增强、导出功能 | 📋 计划中 |
| v0.86 | 2025-09-15 | 文件管理增强 | 📋 计划中 |
| v0.87 | 2025-10-01 | 性能优化 | 📋 计划中 |

---

*最后更新: 2025-07-28*  
*文档版本: 1.0*